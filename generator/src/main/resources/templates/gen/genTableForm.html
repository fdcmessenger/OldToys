<%@page contentType="text/html" pageEncoding="UTF-8"%>
<%@ include file="/views/include/taglib.jsp"%>
﻿<!DOCTYPE HTML>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>选择数据库表</title>
        <%@ include file="/views/include/css.jsp"%>
    </head>
    <body class="popbody">
        <div id="main">
            <form:form id="inputForm" modelAttribute="genTable" action="#" method="post" class="form-horizontal">
                <form:hidden path="id"/>
                <%--<sys:message content="${message}"/>--%>

                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-sm-6  control-label">表名:</label>
                            <div class="col-sm-6 ">
                                <form:input path="name" htmlEscape="false" maxlength="200" class="form-control" readonly="true"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-sm-6  control-label">说明:</label>
                            <div class="col-sm-6 ">
                                <form:input path="comments" htmlEscape="false" maxlength="200" class="form-control"/>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-sm-6  control-label">类名:</label>
                            <div class="col-sm-6 ">
                                <form:input path="className" htmlEscape="false" maxlength="200" class="form-control"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-sm-6  control-label">父表表名:</label>
                            <div class="col-sm-6 ">
                                <form:select path="parentTable" cssClass="form-control">
                                    <form:option value="">无</form:option>
                                    <form:options items="${tableList}" itemLabel="nameAndComments" itemValue="name" htmlEscape="false"/>
                                </form:select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="col-sm-6  control-label">当前表外键：</label>
                            <div class="col-sm-6 ">

                                <form:select path="parentTableFk" cssClass="form-control">
                                    <form:option value="">无</form:option>
                                    <form:options items="${genTable.columnList}" itemLabel="nameAndComments" itemValue="name" htmlEscape="false"/>
                                </form:select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">

                        <p class="help-block"> 如果有父表，请指定父表表名和外键</p>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3">
                        <div class="form-actions col-sm-2">
                            <input id="btnSubmit" class="btn btn-primary " type="submit" value="保 存" />&nbsp;
                        </div>
                        <div class="form-actions col-sm-2">
                            <input id="btnCancel" class="btn btn-danger" type="button" value="刷新" onclick="location.reload();;"/>
                        </div>
                        <div class="form-actions col-sm-2">
                            <input id="btnCancel" class="btn btn-warning" type="button" value="关 闭" onclick="GenTableInfo.close();"/>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 row container">
                    <table id="contentTable" class="bootstrap-table table table-striped table-bordered table-condensed">
                        <thead><tr><th title="数据库字段名">列名</th><th title="默认读取数据库字段备注">说明</th><th title="数据库中设置的字段类型及长度">物理类型</th><th title="实体对象的属性字段类型">Java类型</th>
                                <th title="实体对象的属性字段（对象名.属性名|属性名2|属性名3，例如：用户user.id|name|loginName，属性名2和属性名3为Join时关联查询的字段）">Java属性名称 <i class="icon-question-sign"></i></th>
                                <th title="是否是数据库主键">主键</th><th title="字段是否可为空值，不可为空字段自动进行空值验证">可空</th><th title="选中后该字段被加入到insert语句里">插入</th>
                                <th title="选中后该字段被加入到update语句里">编辑</th><th title="选中后该字段被加入到查询列表里">列表</th>
                                <th title="选中后该字段被加入到查询条件里">查询</th><th title="该字段为查询字段时的查询匹配放松">查询匹配方式</th>
                                <th title="字段在表单中显示的类型">显示表单类型</th><th title="显示表单类型设置为“下拉框、复选框、点选框”时，需设置字典的类型">字典类型</th><th>排序</th></tr></thead>
                        <tbody>
                            <c:forEach items="${genTable.columnList}" var="column" varStatus="vs">
                                <tr>
                                    <td >
                                        <input type="hidden" name="columnList[${vs.index}].id" value="${column.id}"/>
                                        <input type="hidden" name="columnList[${vs.index}].isDbFieldExists" value="${column.isDbFieldExists}"/>
                                        <input type="hidden" name="columnList[${vs.index}].genTable.id" value="${column.genTable.id}"/>
                                        <input type="hidden" name="columnList[${vs.index}].name" value="${column.name}"/>${column.name}${column.isDbFieldExists?"":" (deleted)"}
                                    </td>
                                    <td>
                                        <input type="text" name="columnList[${vs.index}].comments" value="${column.comments}" maxlength="200" class="required" style="width:100px;"/>
                                    </td>
                                    <td >
                                        <input type="hidden" name="columnList[${vs.index}].jdbcType" value="${column.jdbcType}"/>${column.jdbcType}
                                    </td>
                                    <td>
                                        <select name="columnList[${vs.index}].javaType" class="required input-mini" style="width:85px;*width:75px">
                                            <c:forEach items="${config.javaTypeList}" var="dict">
                                                <option value="${dict.value}" ${dict.value==column.javaType?'selected':''} title="${dict.description}">${dict.label}</option>
                                            </c:forEach>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="text" name="columnList[${vs.index}].javaField" value="${column.javaField}" maxlength="200" class="required input-small"/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isPk" ${column.isPk ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isNull" ${column.isNull ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isInsert" ${column.isInsert ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isEdit" ${column.isEdit ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isList" ${column.isList ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="columnList[${vs.index}].isQuery" ${column.isQuery ? 'checked' : ''}/>
                                    </td>
                                    <td>
                                        <select name="columnList[${vs.index}].queryType" class="required input-mini">
                                            <c:forEach items="${config.queryTypeList}" var="dict">
                                                <option value="${dict.value}" ${dict.value==column.queryType?'selected':''} title="${dict.description}">${dict.label}</option>
                                            </c:forEach>
                                        </select>
                                    </td>
                                    <td>
                                        <select name="columnList[${vs.index}].showType" class="required" style="width:100px;">
                                            <c:forEach items="${config.showTypeList}" var="dict">
                                                <option value="${dict.value}" ${dict.value==column.showType?'selected':''} title="${dict.description}">${dict.label}</option>
                                            </c:forEach>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="text" name="columnList[${vs.index}].dictType" value="${column.dictType}" maxlength="200" class="input-mini"/>
                                    </td>
                                    <td>
                                        <input type="text" name="columnList[${vs.index}].sort" value="${column.sort}" maxlength="200" class="required input-min digits"/>
                                    </td>
                                </tr>
                            </c:forEach>
                        </tbody>
                    </table>
                </div>

            </form:form>
        </div>
    </body>
    <%@ include file="/views/include/script.jsp"%>
    <script src="${ctxStatic}/modules/gen/genTableInfo.js"></script>
</html>