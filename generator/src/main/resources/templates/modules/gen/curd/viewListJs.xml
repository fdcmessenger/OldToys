<?xml version="1.0" encoding="utf-8"?>
<template>
    <name>viewList</name>
    <filePath>src/main/resources/META-INF/resources/static/modules/${moduleName}/${subModuleName}</filePath>
    <fileName>${className}List.js</fileName>
    <content><![CDATA[
var ${ClassName} = {
    tableId: "${ClassName}Table", //表格id
    seItem: null, //选中的条目
    seItems: null, //选中的条目
    seIds: null, //选中的条目
    table: null,//bootstrap table 对象
    layerIndex: -1
};        
/**
 * 初始化表格的列
 */
${ClassName}.initColumn = function () {
    var columns = [
        {field: 'selectItem', radio: true},//还可以设为checkbox多选方式
        
        <#assign columnField>
            <#list table.columnList as c>
                    {title: '${c.comments}', field: '${c.javaField}', <#if c.isList?? && c.isList==true>visible: true,<#else>visible: false,</#if>align: 'center', valign: 'middle', sortable: true},
            </#list>
        </#assign>
        ${columnField}
    ];
    return columns;
};        
${ClassName}.checkMore = function () {
    var selected = $('#' + this.tableId).bootstrapTable('getSelections');
    if (selected.length == 0) {
        Feng.info("请先选中表格中的至少一条记录！");
        return false;
    } else {
        ${ClassName}.seItems = selected;
        var ids = new Array();
        for (var i = 0; i < ${ClassName}.seItems.length; i++) {
            ids.push(${ClassName}.seItems[i].id);
        }
        ${ClassName}.seIds = ids;
        return true;
    }
};
/**
 * 检查是否选中
 */
${ClassName}.checkOne = function () {
    var selected = $('#' + this.tableId).bootstrapTable('getSelections');
    if (selected.length == 0 || selected.length > 1) {
        Feng.info("请先选中表格中的某一且只选一条记录！");
        return false;
    } else {
        ${ClassName}.seItem = selected[0];
        return true;
    }
};
/**
 * 点击添加${functionNameSimple}
 */
${ClassName}.openAdd${ClassName} = function () {
    var index = layer.open({
        type: 2,
        title: '添加${functionNameSimple}',
        area: ['800px', '650px'], //宽高,可用写百分比:90%
        fix: false, //不固定
        maxmin: true,
        content: Feng.ctxPath + '/${urlPrefix}/addForm'
    });
//    layer.full(index);//想全屏显示时，请取消注释
    this.layerIndex = index;
};
 /**
 * 点击编辑${functionNameSimple}
 */       
${ClassName}.openEdit${ClassName} = function () {
    if (this.checkOne()) {
        var index = layer.open({
            type: 2,
            title: '编辑${functionNameSimple}',
            area: ['800px', '650px'], //宽高
            fix: false, //不固定
            maxmin: true,
            content: Feng.ctxPath + '/${urlPrefix}/editForm?${className}Id=' + this.seItem.id
        });
        this.layerIndex = index;
    }
};    
/**
 * 点击删除${functionNameSimple}
 */    
${ClassName}.delete = function () {
    if (this.checkOne()) {
        var operation = function () {
            var ajax = new $ax(Feng.ctxPath + "/${urlPrefix}/delete",function(data) {
                if (data.message)
                    Feng.success(data.message);
                else
                    Feng.success("删除成功!");
                ${ClassName}.table.refresh();
            }, function (data) {
                Feng.error("删除失败!" + data.responseJSON.message + "!");
            });
            ajax.set("${className}Id", ${ClassName}.seItem.id);
            ajax.start();
        };
        Feng.confirm("是否刪除该${functionNameSimple}?", operation);
    }
}; 
${ClassName}.resetSearch = function () {
    ${ClassName}.search();
};

${ClassName}.search = function () {
    var queryData = {};
    ${ClassName}.table.refresh({query: queryData});
};
$(function () {
    var defaultColunms = ${ClassName}.initColumn();
    var table = new BSTable(${ClassName}.tableId, "/${urlPrefix}/listData", defaultColunms);
    ${ClassName}.table = table.init();
//    ${ClassName}.table = table.init({height: 500, pageSize: 2});//可以通过自定义bootstrap table 属性的方式进行个性设定
    $(window).resize(function () {//接收浏览器的resize事件，对bt进行大小重置
        ${ClassName}.table.resetSize(Feng.getHeight());
    });

});   
   ]]>
    </content>
</template>